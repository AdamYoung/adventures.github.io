import{r as d,K as I,f as H,n as E,g as F,o as u,c as r,b as L,w as G,a as e,G as z,z as V,D as b,F as K,p as R,t as W,T as q,B as M,L as C,d as j,H as O}from"./D1IgBj9a.js";import{_ as J}from"./DlAUqK2U.js";function Q(){const l=d(null),a=d(!1);function o(p,s,c){if(y(),!("speechSynthesis"in window)){console.error("Speech synthesis not supported");return}l.value=new SpeechSynthesisUtterance(p),l.value.lang="en-US",l.value.rate=1;const x=p+" ";l.value.onboundary=f=>{if(f.type==="word"){const n=f.charIndex,t=x.slice(0,n).trim().split(/\s+/).length-1;s(t)}},l.value.onend=()=>{a.value=!1,c==null||c()},a.value=!0,window.speechSynthesis.speak(l.value)}function y(){l.value&&(window.speechSynthesis.cancel(),a.value=!1,l.value=null)}return{speak:o,stop:y,isPlaying:a}}const X={class:"slideshow"},Y={key:"next",class:"slide next"},Z={key:"current",class:"slide current"},ee=["src"],te={class:"controls"},ae={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},le={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},oe={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},se={key:0,d:"M12 6L8 10H4v4h4l4 4V6z M16 8.5a5 5 0 0 1 0 7 M19 6a8 8 0 0 1 0 12","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},ne={key:1,d:"M12 6L8 10H4v4h4l4 4V6z M18 12l3-3 M18 12l3 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},ie={__name:"Story",props:{slides:{type:Array,required:!0,validator:l=>l.every(a=>typeof a.text=="string"&&(typeof a.image=="string"||typeof a.video=="string"))}},setup(l){const a=l,o=d(0),y=d([]),p=d(-1),s=d(!1),c=d(!1),{speak:x,stop:f}=Q(),n=I(()=>a.slides[o.value]),T=I(()=>o.value<a.slides.length-1?a.slides[o.value+1]:null),t=d(null),h=d(!1),g=d(!0),_=d(!0),m=d(!1);function P(){s.value=!1,h.value=!1,t.value?(t.value.currentTime=0,setTimeout(()=>{h.value=!0,t.value.play(),k()},500)):k()}H(n,()=>{},{immediate:!0}),E(()=>{"speechSynthesis"in window?setTimeout(()=>{k()},500):console.error("Speech synthesis not supported")}),F(()=>{f()});function S(){t.value&&(t.value.pause(),t.value.currentTime=0)}function k(){f(),S(),y.value=n.value.text.split(" "),p.value=-1,s.value=!1,h.value=!1,_.value=!0,console.log("here",n.value,t.value),n.value.video&&t.value?(t.value.load(),setTimeout(()=>{m.value?(s.value=!0,h.value=!0,_.value=!1,t.value.play().catch(v=>console.warn("Video playback failed:",v))):x(n.value.text,v=>p.value=v,()=>{s.value=!0,t.value.currentTime=0,h.value=!0,_.value=!1,t.value.play().catch(v=>console.warn("Video playback failed:",v))})},500)):setTimeout(()=>{m.value?(s.value=!0,g.value&&setTimeout(()=>w(),1500)):x(n.value.text,v=>p.value=v,()=>{s.value=!0,g.value&&setTimeout(()=>w(),1500)})},500)}function A(){g.value&&setTimeout(()=>{w()},300)}function w(){o.value<a.slides.length-1&&!c.value&&(c.value=!0,h.value=!1,S(),f(),o.value++,setTimeout(()=>{c.value=!1,k()},500))}function D(){o.value>0&&!c.value&&(c.value=!0,h.value=!1,S(),f(),o.value--,setTimeout(()=>{c.value=!1,k()},500))}function N(){g.value=!g.value,g.value&&s.value&&(t.value?(h.value=!0,t.value.play().catch(v=>console.warn("Video playback failed:",v))):w())}function U(){m.value=!m.value,m.value?f():s.value||k()}return(v,i)=>(u(),r("div",X,[L(q,{name:"fade"},{default:G(()=>[T.value?(u(),r("div",Y,[e("div",{class:"slide-media",style:z({backgroundImage:`url(${T.value.image||""})`})},null,4)])):V("",!0),n.value?(u(),r("div",Z,[e("div",{class:"slide-media",style:z({backgroundImage:`url(${n.value.image||""})`})},null,4),n.value.video?(u(),r("video",{key:0,ref_key:"currentVideo",ref:t,class:b(["slide-media",{"video-ready":h.value}]),src:n.value.video,preload:"auto",muted:"",playsinline:"",loop:!1,onEnded:A},null,42,ee)):V("",!0),e("div",{class:b(["slide-text",{"fade-out":!_.value}])},[(u(!0),r(K,null,R(y.value,($,B)=>(u(),r("span",{key:`${o.value}-${B}`,class:b({highlight:B===p.value})},W($),3))),128))],2)])):V("",!0)]),_:1}),e("div",te,[M(e("button",{class:"control-button left",onClick:D,"aria-label":"Previous slide"},i[0]||(i[0]=[e("svg",{class:"chevron",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M15.5 5.5L8.5 12l7 6.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),512),[[C,o.value>0]]),M(e("button",{class:b(["control-button right",{pulse:s.value}]),onClick:w,"aria-label":"Next slide"},i[1]||(i[1]=[e("svg",{class:"chevron",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M8.5 5.5L15.5 12l-7 6.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2),[[C,o.value<l.slides.length-1]])]),e("button",{class:"control-button auto-play",onClick:N,"aria-label":"Toggle auto play"},[g.value?(u(),r("svg",le,i[3]||(i[3]=[e("path",{d:"M6 4h4v16H6V4zM14 4h4v16h-4V4z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):(u(),r("svg",ae,i[2]||(i[2]=[e("path",{d:"M5 3l14 9-14 9V3z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))),i[4]||(i[4]=e("span",null,[j("Auto"),e("br"),j("Play")],-1))]),M(e("button",{class:"control-button replay",onClick:P,"aria-label":"Replay slide"},i[5]||(i[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M3 12a9 9 0 1 1 2.83 6.54M3 12V8m0 4h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),512),[[C,s.value&&!g.value]]),e("button",{class:"control-button speech-toggle",onClick:U,"aria-label":"Toggle speech"},[(u(),r("svg",oe,[m.value?(u(),r("path",ne)):(u(),r("path",se))]))])]))}},ue=J(ie,[["__scopeId","data-v-33ee0543"]]),ce={__name:"story",setup(l){var a=[{image:"page1.png",video:"page1.mp4",text:"In a house by the hill where the wildflowers sway, Lived a baby and her husky who loved to play all day."},{image:"page2.png",video:"page2.mp4",text:"They danced with the clouds and chased butterflies, Painting the day with the colors of skies."},{image:"page3.png",video:"page3.mp4",text:"One morning they set off to see what they'd find, Through forests so lush and paths that wind."},{image:"page4.png",video:"page4.mp4",text:"They sailed on a leaf down a glistening stream, Chasing the echoes of a faraway dream"},{image:"page6.png",video:"page6.mp4",text:"They climbed a tall tree to see the world wide, Discovering wonders from their perch up high."},{image:"page7.png",video:"page7.mp4",text:"As stars peeked out and the sun said goodnight, They headed back home by the moon's soft light."}];return(o,y)=>{const p=ue;return u(),r("div",null,[L(p,{slides:O(a),musicSrc:"Mya and Kita's Adventure.mp3"},null,8,["slides"])])}}};export{ce as default};
